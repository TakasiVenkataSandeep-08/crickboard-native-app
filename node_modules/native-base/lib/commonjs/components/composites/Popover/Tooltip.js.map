{"version":3,"sources":["Tooltip.tsx"],"names":["Tooltip","React","PureComponent","isVisible","yOffset","xOffset","elementWidth","elementHeight","onClose","props","getElementPosition","setState","prevState","isIOS","actionType","children","toggleTooltip","undefined","toggleWrapperProps","state","height","width","withPointer","containerStyle","x","y","ScreenWidth","ScreenHeight","position","left","I18nManager","isRTL","right","top","display","alignItems","justifyContent","flex","borderRadius","paddingTop","paddingBottom","tooltipY","backgroundColor","pointerStyle","pastMiddleLine","styling","withTooltip","popover","highlightColor","wrapWithAction","tooltipStyle","getTooltipStyle","overflow","renderPointer","borderColor","borderWidth","renderedElement","measureInWindow","pageOffsetX","pageOffsetY","componentDidMount","timeout","setTimeout","componentWillUnmount","clearTimeout","render","withOverlay","onOpen","overlayColor","e","renderContent","closeOnBlur","opacity","bottom","closeOnPopoverPress","styles","container","defaultProps","zIndex"],"mappings":"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","sourcesContent":["import * as React from 'react';\nimport { I18nManager, Modal, TouchableOpacity } from 'react-native';\nimport { View } from '../../primitives';\nimport getTooltipCoordinate from './getTooltipCoordinate';\nimport { isIOS, ScreenHeight, ScreenWidth } from './helpers';\nimport Triangle from './Triangle';\n\ntype State = {\n  isVisible: boolean;\n  yOffset: number;\n  xOffset: number;\n  elementWidth: number;\n  elementHeight: number;\n};\n\nexport type Props = {\n  children?: JSX.Element | JSX.Element[];\n  withPointer?: boolean;\n  popover?: JSX.Element;\n  height?: number | string;\n  width?: number | string;\n  containerStyle?: any;\n  pointerColor?: string;\n  pointerStyle?: {};\n  onClose?: () => void;\n  onOpen?: () => void;\n  withOverlay?: boolean;\n  overlayColor?: string;\n  backgroundColor?: string;\n  highlightColor?: string;\n  toggleWrapperProps?: {};\n  closeOnPopoverPress?: boolean;\n  closeOnBlur?: boolean;\n  actionType?: 'press' | 'longPress' | 'none';\n  borderColor?: string;\n  borderWidth?: number;\n};\n\nclass Tooltip extends React.PureComponent<Props, State> {\n  state = {\n    isVisible: false,\n    yOffset: 0,\n    xOffset: 0,\n    elementWidth: 0,\n    elementHeight: 0,\n  };\n\n  renderedElement: any;\n  timeout: any;\n\n  static defaultProps: {\n    toggleWrapperProps: {};\n    withOverlay: true;\n    highlightColor: 'transparent';\n    withPointer: true;\n    actionType: 'press';\n    height: 40;\n    width: 150;\n    containerStyle: {};\n    pointerStyle: {};\n    backgroundColor: '#617080';\n    onClose: () => void;\n    onOpen: () => void;\n  };\n\n  toggleTooltip = () => {\n    const { onClose } = this.props;\n    this.getElementPosition();\n    this.setState((prevState) => {\n      if (prevState.isVisible && !isIOS) {\n        onClose && onClose();\n      }\n      return { isVisible: !prevState.isVisible };\n    });\n  };\n\n  wrapWithAction = (actionType: any, children: {} | null | undefined) => {\n    if (actionType === 'press' || actionType === 'longPress') {\n      return (\n        <TouchableOpacity\n          onPress={actionType === 'press' ? this.toggleTooltip : undefined}\n          onLongPress={\n            actionType === 'longPress' ? this.toggleTooltip : undefined\n          }\n          activeOpacity={1}\n          {...this.props.toggleWrapperProps}\n        >\n          {children}\n        </TouchableOpacity>\n      );\n    }\n    return children;\n  };\n\n  getTooltipStyle = () => {\n    const { yOffset, xOffset, elementHeight, elementWidth } = this.state;\n    const { height, width, withPointer, containerStyle } = this.props;\n\n    const { x, y } = getTooltipCoordinate(\n      xOffset,\n      yOffset,\n      elementWidth,\n      elementHeight,\n      ScreenWidth,\n      ScreenHeight,\n      width,\n      height,\n      withPointer\n    );\n\n    return {\n      position: 'absolute',\n      left: I18nManager.isRTL ? null : x,\n      right: I18nManager.isRTL ? x : null,\n      top: y,\n      width,\n      height,\n      // default styles\n      display: 'flex',\n      alignItems: 'center',\n      justifyContent: 'center',\n      flex: 1,\n      borderRadius: 10,\n      paddingTop: 10,\n      paddingBottom: 10,\n      // borderWidth: 1,\n      // borderColor: '#CBD5E0',\n      ...containerStyle,\n    };\n  };\n\n  renderPointer = (tooltipY: any) => {\n    const { yOffset, xOffset, elementHeight, elementWidth } = this.state;\n    const { backgroundColor, pointerStyle } = this.props;\n    const pastMiddleLine = yOffset > tooltipY;\n    const styling: any = {\n      position: 'absolute',\n      top: pastMiddleLine ? yOffset - 13 : yOffset + elementHeight - 2,\n      left: I18nManager.isRTL ? null : xOffset + elementWidth / 2 - 7.5,\n      right: I18nManager.isRTL ? xOffset + elementWidth / 2 - 7.5 : null,\n    };\n    return (\n      <View style={styling}>\n        <Triangle\n          borderBottomColor={backgroundColor}\n          style={{\n            ...pointerStyle,\n          }}\n          isDown={pastMiddleLine}\n        />\n      </View>\n    );\n  };\n  renderContent = (withTooltip: any) => {\n    const { popover, withPointer, highlightColor, actionType } = this.props;\n\n    if (!withTooltip)\n      return this.wrapWithAction(actionType, this.props.children);\n\n    const { yOffset, xOffset, elementWidth, elementHeight } = this.state;\n    const tooltipStyle = this.getTooltipStyle();\n    const styling: any = {\n      position: 'absolute',\n      top: yOffset,\n      left: I18nManager.isRTL ? null : xOffset,\n      right: I18nManager.isRTL ? xOffset : null,\n      backgroundColor: highlightColor,\n      overflow: 'visible',\n      width: elementWidth,\n      height: elementHeight,\n    };\n    return (\n      <View>\n        <View style={styling}>{this.props.children}</View>\n        {withPointer && this.renderPointer(tooltipStyle.top)}\n        <View\n          bg={this.props.backgroundColor}\n          borderColor={this.props.borderColor}\n          borderWidth={this.props.borderWidth}\n          style={tooltipStyle}\n        >\n          {popover}\n        </View>\n      </View>\n    );\n  };\n\n  componentDidMount() {\n    // wait to compute onLayout values.\n    this.timeout = setTimeout(this.getElementPosition, 500);\n  }\n\n  componentWillUnmount() {\n    clearTimeout(this.timeout);\n  }\n\n  getElementPosition = () => {\n    this.renderedElement &&\n      this.renderedElement.measureInWindow(\n        (pageOffsetX: any, pageOffsetY: any, width: any, height: any) => {\n          this.setState({\n            xOffset: pageOffsetX,\n            yOffset: pageOffsetY,\n            elementWidth: width,\n            elementHeight: height,\n          });\n        }\n      );\n  };\n\n  render() {\n    const { isVisible } = this.state;\n    const { onClose, withOverlay, onOpen, overlayColor } = this.props;\n\n    return (\n      <View collapsable={false} ref={(e: any) => (this.renderedElement = e)}>\n        {this.renderContent(false)}\n        <Modal\n          animationType=\"fade\"\n          visible={isVisible}\n          transparent\n          onDismiss={onClose}\n          onShow={onOpen}\n          onRequestClose={onClose}\n        >\n          {this.props.closeOnBlur ? (\n            <TouchableOpacity\n              style={{\n                position: 'absolute',\n                left: 0,\n                top: 0,\n                opacity: 0.5,\n                right: 0,\n                bottom: 0,\n              }}\n              onPress={this.toggleTooltip}\n            />\n          ) : null}\n\n          {this.props.closeOnPopoverPress ? (\n            <TouchableOpacity\n              style={styles.container(withOverlay, overlayColor)}\n              onPress={this.toggleTooltip}\n              activeOpacity={1}\n            >\n              <View>{this.renderContent(true)}</View>\n            </TouchableOpacity>\n          ) : (\n            this.renderContent(true)\n          )}\n        </Modal>\n      </View>\n    );\n  }\n}\nTooltip.defaultProps = {\n  toggleWrapperProps: {},\n  withOverlay: true,\n  highlightColor: 'transparent',\n  withPointer: true,\n  actionType: 'press',\n  height: 40,\n  width: 150,\n  containerStyle: {},\n  pointerStyle: {},\n  backgroundColor: '#617080',\n  onClose: () => {},\n  onOpen: () => {},\n};\nconst styles = {\n  container: (withOverlay: any, overlayColor: any) => ({\n    backgroundColor: withOverlay\n      ? overlayColor\n        ? overlayColor\n        : 'rgba(250, 250, 250, 0.70)'\n      : 'transparent',\n    flex: 1,\n    zIndex: -1,\n  }),\n};\n\nexport default Tooltip;\n"]}