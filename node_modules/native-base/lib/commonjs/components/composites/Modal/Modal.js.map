{"version":3,"sources":["Modal.tsx"],"names":["ModalWeb","initialFocusRef","finalFocusRef","children","current","focus","finalRef","StyledModal","RNModal","color","space","layout","flexbox","border","position","customPosition","customBorder","customBackground","customOutline","customShadow","customExtra","customLayout","Modal","isOpen","onClose","justifyContent","alignItems","id","motionPreset","avoidKeyboard","overlayColor","overlayVisible","props","ref","closeOverlay","setOverlay","isVisible","setIsVisible","React","useState","closeOverlayInMobile","contentSize","newProps","value","visible","toggleVisible","toggleOnClose","modalChildren","closeOnOverlayClick","useEffect","Platform","OS","closeOnPress","backgroundColor","undefined","disableOverlay","memo","forwardRef"],"mappings":"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","sourcesContent":["import React, { RefObject, useEffect, ReactNode } from 'react';\nimport { KeyboardAvoidingView, Modal as RNModal, Platform } from 'react-native';\nimport styled from 'styled-components/native';\nimport { border, color, flexbox, layout, position, space } from 'styled-system';\nimport { useOverlay } from '../../../core/Overlay';\nimport { useThemeProps } from '../../../hooks';\n//@ts-ignore - Todo - fix types to typings in rn-aria in next version\nimport { FocusScope } from '@react-native-aria/focus';\nimport {\n  customBackground,\n  customBorder,\n  customExtra,\n  customLayout,\n  customOutline,\n  customPosition,\n  customShadow,\n} from '../../../utils/customProps';\nimport { Box, View } from '../../primitives';\nimport type { IModalProps, IModalSemiProps } from './types';\nimport { default as ModalOverlay } from './ModalOverlay';\nimport { ModalContext } from './Context';\n\nconst ModalWeb = ({\n  initialFocusRef,\n  finalFocusRef,\n  children,\n}: {\n  initialFocusRef?: RefObject<any>;\n  finalFocusRef?: RefObject<any>;\n  children: ReactNode;\n}): any => {\n  useEffect(() => {\n    initialFocusRef?.current?.focus();\n    const finalRef = finalFocusRef?.current;\n    return () => {\n      finalRef?.focus();\n    };\n  }, [initialFocusRef, finalFocusRef]);\n  return children;\n};\n\nconst StyledModal = styled(RNModal)<IModalSemiProps>(\n  color,\n  space,\n  layout,\n  flexbox,\n  border,\n  position,\n  customPosition,\n  customBorder,\n  customBackground,\n  customOutline,\n  customShadow,\n  customExtra,\n  customLayout\n);\n\nconst Modal = (\n  {\n    children,\n    isOpen,\n    onClose,\n    initialFocusRef,\n    finalFocusRef,\n    justifyContent,\n    alignItems,\n    id,\n    motionPreset,\n    avoidKeyboard,\n    overlayColor,\n    overlayVisible,\n    ...props\n  }: IModalProps,\n  ref?: any\n) => {\n  const { closeOverlay, setOverlay } = useOverlay();\n  const [isVisible, setIsVisible] = React.useState(true);\n  const closeOverlayInMobile = () => {\n    setIsVisible(false);\n    onClose(false);\n  };\n  const { contentSize, ...newProps } = useThemeProps('Modal', props);\n\n  const value: any = {\n    visible: isVisible,\n    toggleVisible: setIsVisible,\n    toggleOnClose: onClose ? onClose : () => {},\n    contentSize: contentSize,\n  };\n  const modalChildren = (\n    <Box\n      {...newProps}\n      justifyContent={justifyContent ?? 'center'}\n      alignItems={alignItems ?? 'center'}\n    >\n      {newProps.closeOnOverlayClick === false ? <Box /> : <ModalOverlay />}\n      {children}\n    </Box>\n  );\n  React.useEffect(\n    () => {\n      isOpen && Platform.OS === 'web'\n        ? setOverlay(\n            <ModalContext.Provider value={value}>\n              <FocusScope\n                contain\n                restoreFocus={!(finalFocusRef && finalFocusRef.current)}\n                autoFocus={!(initialFocusRef && initialFocusRef.current)}\n              >\n                <Box ref={ref} nativeID={id} h=\"100%\">\n                  <ModalWeb\n                    initialFocusRef={initialFocusRef}\n                    finalFocusRef={finalFocusRef}\n                  >\n                    {modalChildren}\n                  </ModalWeb>\n                </Box>\n              </FocusScope>\n            </ModalContext.Provider>,\n            {\n              onClose: onClose,\n              closeOnPress:\n                newProps.closeOnOverlayClick === false ? false : true,\n              backgroundColor: overlayColor ? overlayColor : undefined,\n              disableOverlay: overlayVisible === false ? true : false,\n              motionPreset: motionPreset ?? 'fade',\n              position:\n                justifyContent === 'flex-start'\n                  ? 'top'\n                  : justifyContent === 'flex-end'\n                  ? 'bottom'\n                  : 'center',\n            }\n          )\n        : setOverlay(<Box />, {\n            onClose: closeOverlayInMobile,\n            closeOnPress: newProps.closeOnOverlayClick === false ? false : true,\n            backgroundColor: overlayColor ? overlayColor : undefined,\n            disableOverlay: overlayVisible === false ? true : false,\n          });\n\n      !isOpen && closeOverlay();\n      setIsVisible(isOpen);\n    },\n    /*eslint-disable */\n    [isOpen]\n  );\n  return Platform.OS !== 'web' ? (\n    <ModalContext.Provider value={value}>\n      <View nativeID={id}>\n        <StyledModal\n          visible={isVisible}\n          onRequestClose={() => {\n            value.toggleVisible(false);\n            value.toggleOnClose(false);\n          }}\n          onShow={() => initialFocusRef?.current?.focus()}\n          onDismiss={() => finalFocusRef?.current?.focus()}\n          animationType={motionPreset || 'fade'}\n          transparent\n          {...newProps}\n          ref={ref}\n        >\n          {avoidKeyboard ? (\n            <KeyboardAvoidingView\n              behavior={Platform.OS === 'ios' ? 'padding' : 'height'}\n            >\n              {modalChildren}\n            </KeyboardAvoidingView>\n          ) : (\n            modalChildren\n          )}\n        </StyledModal>\n      </View>\n    </ModalContext.Provider>\n  ) : null;\n};\n\nexport default React.memo(React.forwardRef(Modal));\n\nexport type { IModalProps };\n"]}